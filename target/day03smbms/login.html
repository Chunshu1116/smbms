<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>系统登录 - 超市账单管理系统</title>
    <link rel="stylesheet" href="css/style.css"/>
    <script src="js/jquery.js"></script>
</head>
<body class="login_bg" onload="user.isLogin()">
    <section class="loginBox">
        <header class="loginHeader">
            <h1>超市账单管理系统</h1>
        </header>
        <section class="loginCont">
            <form class="loginForm">
                <div class="inputbox">
                    <label for="user">用户名：</label>
                    <input id="user" type="text" name="username" placeholder="请输入用户名" required/>
                </div>
                <div class="inputbox">
                    <label for="mima">密码：</label>
                    <input id="mima" type="password" name="password" placeholder="请输入密码" required/>
                </div>
                <div>
                    <span id="login_message" style="color: red"></span>
                </div>
                <div class="subBtn">
                    <input type="button" onclick="login()" value="登录" />
                    <input type="reset" value="重置"/>
                </div>

            </form>
        </section>
    </section>

</body>
<script src="js/user.js"></script>
<script>
    function login(){
        var username=$("#user").val();
        var password=$("#mima").val();
        $.get('/login/'+username+"/"+password,function (data) {
            if(data.success){
                //登录成功
                var user=data.data.user;
                var date=new Date();
                date.setTime(date.getTime()+24*60*60*1000);
                document.cookie="userName="+username+"; expires="+date.toUTCString();
                document.cookie="userId="+user.id+"; expires="+date.toUTCString();
                window.location="welcome.html";
            }else {
                console.log(data.message);
                $("#login_message").text(data.message);
            }
        })
    }
</script>
</html>